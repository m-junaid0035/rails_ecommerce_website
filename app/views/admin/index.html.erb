<h1 class="text-4xl font-bold text-gray-800 mb-6">Admin Dashboard</h1>

<div class="space-y-12 max-w-7xl mx-auto">

  <!-- Daily Stats -->
  <section>
    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Daily Stats</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <% stats = {
          "Revenue" => @quick_stats[:revenue] ? (@quick_stats[:revenue] / 100.0) : 0,
          "Total Sales" => @quick_stats[:sales] || 0,
          "Average Sale" => @quick_stats[:avg_sale] ? (@quick_stats[:avg_sale] / 100.0) : 0,
          "Items/Sale" => @quick_stats[:per_sale].to_i
        } %>

      <% stats.each do |label, value| %>
        <div class="rounded-xl shadow-lg bg-gradient-to-r from-gray-500 to-gray-400 p-6">
          <div class="text-white text-lg font-semibold mb-2"><%= label %></div>
          <div class="text-white text-2xl font-bold">
            <%= label.include?("Revenue") || label.include?("Average") ? "$#{value}" : value %>
          </div>
        </div>
      <% end %>
    </div>
  </section>

  <!-- Revenue Chart -->
  <section>
    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Revenue Chart</h2>
    <div class="bg-white shadow-md rounded-lg p-4">
      <div class="w-full" data-controller="dashboard" data-dashboard-revenue-value="<%= @revenue_by_day.to_json %>">
        <canvas id="revenueChart" aria-label="Revenue over time chart" role="img"></canvas>
      </div>
    </div>
  </section>

  <!-- Unfulfilled Orders -->
  <section>
    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Recent Unfulfilled Orders</h2>
    <div class="overflow-x-auto shadow-md rounded-lg">
      <table class="min-w-full bg-white divide-y divide-gray-200">
        <thead class="bg-gray-100 text-gray-600 uppercase text-sm tracking-wider">
          <tr>
            <th class="px-6 py-3 text-left">Order ID</th>
            <th class="px-6 py-3 text-left">Customer</th>
            <th class="px-6 py-3 text-left">Date</th>
            <th class="px-6 py-3 text-left">Amount</th>
          </tr>
        </thead>
        <tbody class="text-gray-700 divide-y divide-gray-100">
          <% @orders.each do |order| %>
            <tr>
              <td class="px-6 py-4">
                <%= link_to order.id, admin_order_path(order), class: "text-blue-600 hover:underline font-medium" %>
              </td>
              <td class="px-6 py-4">
                <%= order.customer_email %>
              </td>
              <td class="px-6 py-4">
                <%= order.created_at.strftime("%B %d, %Y %H:%M") %>
              </td>
              <td class="px-6 py-4">
                $<%= (order.total / 100.0).round(2) %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </section>

</div>
